<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Multi-LLM Chat - AI Powered Conversations</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="app-title">
                        <span class="title-icon">ü§ñ</span>
                        Enhanced Multi-LLM Chat
                    </h1>
                    <p class="app-subtitle">
                        Chat with OpenAI, Anthropic, Microsoft AI, Adobe AI, Canva, Perplexity & more
                    </p>
                </div>
                <div class="header-right">
                    <div class="model-selector">
                        <button id="modelBtn" class="btn btn--secondary model-btn">
                            <span class="model-info">
                                <span class="current-provider" id="currentProvider">Select Provider</span>
                                <span class="current-model" id="currentModel">Choose a model to start</span>
                            </span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </button>
                        <div id="modelDropdown" class="model-dropdown">
                            <!-- Populated dynamically -->
                        </div>
                    </div>
                    <div class="header-actions" style="display:flex; gap:8px; align-items:center; margin-left:12px;">
                        <a href="/translate" class="btn btn--outline">Go to Translator</a>
                    </div>
                </div>
            </div>

            <!-- Navigation Links -->
            <div class="navigation">
                <a href="/" class="nav-link active">
                    <span>üí¨</span>
                    Chat
                </a>
                <a href="/translate" class="nav-link">
                    <span>üåê</span>
                    Translator
                </a>
            </div>

            <!-- Capability Tabs -->
            <div class="capability-tabs" id="capabilityTabs">
                <button class="capability-tab active" data-capability="chat">
                    üí¨ Chat
                </button>
                <button class="capability-tab" data-capability="image">
                    üé® Image
                </button>
                <button class="capability-tab disabled" data-capability="design">
                    üéØ Design
                </button>
                <button class="capability-tab" data-capability="web-search">
                    üîç Search
                </button>
            </div>
        </header>

        <main class="chat-main">
            <div class="chat-container">
                <div class="chat-messages" id="messagesContainer">
                    <div class="welcome-message">
                        <div class="welcome-icon">üöÄ</div>
                        <h2>Welcome to Enhanced Multi-LLM Chat!</h2>
                        <p>
                            Experience the power of multiple AI providers in one place. 
                            Choose your preferred AI model and start chatting, generating images, 
                            creating designs, or searching the web with advanced language models.
                        </p>
                        <div class="feature-grid">
                            <div class="feature-item">
                                <span class="feature-icon">üí¨</span>
                                <span>Multi-Provider Chat</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üé®</span>
                                <span>AI Image Generation</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üéØ</span>
                                <span>Design Creation</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">üîç</span>
                                <span>Web Search</span>
                            </div>
                        </div>
                        <p class="welcome-cta">
                            <strong>Select a model above and start exploring!</strong>
                        </p>
                    </div>
                </div>

                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <span class="typing-text">AI is thinking...</span>
                </div>

                <div class="chat-input-container">
                    <div class="input-actions">
                        <button class="action-btn" id="clearChatBtn" title="Clear chat">
                            üóëÔ∏è
                        </button>
                        <button class="action-btn" id="settingsBtn" title="Settings">
                            ‚öôÔ∏è
                        </button>
                    </div>
                    
                    <div class="input-wrapper">
                        <textarea 
                            id="messageInput" 
                            class="message-input" 
                            placeholder="Type your message here..."
                            rows="1"
                            maxlength="4000">
                        </textarea>
                        <button id="sendButton" class="send-button" disabled>
                            <span class="send-icon">‚ñ∂</span>
                        </button>
                    </div>
                    
                    <div class="input-info">
                        <div class="char-count" id="charCount">0 characters</div>
                        <div class="model-info" id="modelInfo">Select a model to begin</div>
                        <div class="keyboard-shortcuts">
                            Press <kbd>Enter</kbd> to send, <kbd>Shift+Enter</kbd> for new line
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <div class="footer-content">
                <div class="footer-left">
                    <span class="footer-text">Enhanced Multi-LLM Chat v2.0</span>
                    <span class="provider-status">
                        <span class="status-indicator" id="healthStatus">üü° Checking...</span>
                    </span>
                </div>
                <div class="footer-right">
                    <span class="keyboard-hint">
                        <kbd>Ctrl</kbd> + <kbd>Enter</kbd> to focus input | 
                        <kbd>Ctrl</kbd> + <kbd>K</kbd> to clear chat |
                        <kbd>Ctrl</kbd> + <kbd>1-5</kbd> to switch capabilities
                    </span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Enhanced Notifications Container -->
    <div id="notifications" class="notifications-container"></div>

    <!-- Scripts -->
    <script src="js/llmProviders.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>
    

    <!-- Health Check Script -->
    <script>
        // Health check for providers
        async function checkProviderHealth() {
            try {
                const response = await fetch('/api/health');
                const health = await response.json();
                
                const healthStatus = document.getElementById('healthStatus');
                const healthyProviders = Object.values(health).filter(h => h === true).length;
                const totalProviders = Object.keys(health).length;
                
                if (healthyProviders === totalProviders) {
                    healthStatus.textContent = `üü¢ All ${totalProviders} providers healthy`;
                    healthStatus.className = 'status-indicator healthy';
                } else if (healthyProviders > 0) {
                    healthStatus.textContent = `üü° ${healthyProviders}/${totalProviders} providers healthy`;
                    healthStatus.className = 'status-indicator partial';
                } else {
                    healthStatus.textContent = `üî¥ No providers available`;
                    healthStatus.className = 'status-indicator unhealthy';
                }
            } catch (error) {
                const healthStatus = document.getElementById('healthStatus');
                healthStatus.textContent = `üî¥ Health check failed`;
                healthStatus.className = 'status-indicator unhealthy';
            }
        }

        // Run health check on load and periodically
        document.addEventListener('DOMContentLoaded', () => {
            checkProviderHealth();
            // Check health every 30 seconds
            setInterval(checkProviderHealth, 30000);
        });

        // Enhanced error handling
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            if (window.app?.ui) {
                window.app.ui.showError('An unexpected error occurred. Please refresh if issues persist.');
            }
        });

        // Service Worker registration (for future PWA features)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <style>
        /* Additional styles for new features */
        .capability-tabs {
            display: flex;
            gap: var(--space-4);
            padding: var(--space-12) var(--space-20);
            background: var(--color-surface);
            border-bottom: 1px solid var(--color-border);
            overflow-x: auto;
        }

        .capability-tab {
            padding: var(--space-8) var(--space-16);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-full);
            background: transparent;
            color: var(--color-text);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-standard);
            white-space: nowrap;
        }

        .capability-tab:hover:not(.disabled) {
            background: var(--color-secondary);
            border-color: var(--color-primary);
        }

        .capability-tab.active {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
            border-color: var(--color-primary);
        }

        .capability-tab.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--color-secondary);
        }

        .welcome-message {
            text-align: center;
            padding: var(--space-32);
            max-width: 600px;
            margin: 0 auto;
        }

        .welcome-icon {
            font-size: 3rem;
            margin-bottom: var(--space-16);
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--space-16);
            margin: var(--space-24) 0;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: var(--space-8);
            padding: var(--space-12);
            background: var(--color-secondary);
            border-radius: var(--radius-base);
            font-size: var(--font-size-sm);
        }

        .feature-icon {
            font-size: 1.2rem;
        }

        .welcome-cta {
            margin-top: var(--space-24);
            font-size: var(--font-size-lg);
        }

        .model-dropdown .dropdown-section {
            margin-bottom: var(--space-12);
        }

        .dropdown-section-header {
            font-weight: var(--font-weight-semibold);
            color: var(--color-primary);
            padding: var(--space-8) var(--space-12);
            font-size: var(--font-size-sm);
            border-bottom: 1px solid var(--color-border);
            margin-bottom: var(--space-4);
        }

        .model-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .model-name {
            font-weight: var(--font-weight-medium);
        }

        .model-capabilities {
            margin-top: var(--space-4);
            display: flex;
            gap: var(--space-4);
            flex-wrap: wrap;
        }

        .capability-badge {
            font-size: var(--font-size-xs);
            padding: var(--space-2) var(--space-6);
            background: var(--color-secondary);
            border-radius: var(--radius-sm);
            color: var(--color-text-secondary);
        }

        .capability-badge.active {
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
        }

        .notifications-container {
            position: fixed;
            top: var(--space-20);
            right: var(--space-20);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: var(--space-8);
        }

        .notification {
            padding: var(--space-12) var(--space-16);
            border-radius: var(--radius-base);
            font-weight: var(--font-weight-medium);
            box-shadow: var(--shadow-lg);
            max-width: 300px;
            animation: slideIn 0.3s ease-out;
        }

        .notification.success {
            background: var(--color-success);
            color: white;
        }

        .notification.error {
            background: var(--color-error);
            color: white;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .status-indicator {
            font-size: var(--font-size-sm);
        }

        .status-indicator.healthy { color: var(--color-success); }
        .status-indicator.partial { color: var(--color-warning); }
        .status-indicator.unhealthy { color: var(--color-error); }

        .generated-image {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-base);
            margin: var(--space-8) 0;
        }

        .design-link {
            display: inline-block;
            padding: var(--space-8) var(--space-16);
            background: var(--color-primary);
            color: var(--color-btn-primary-text);
            text-decoration: none;
            border-radius: var(--radius-base);
            margin: var(--space-8) 0;
        }

        .design-link:hover {
            background: var(--color-primary-hover);
        }

        kbd {
            background: var(--color-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            padding: var(--space-2) var(--space-4);
            font-size: var(--font-size-xs);
            font-family: var(--font-family-mono);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: var(--space-16);
            }

            .capability-tabs {
                padding: var(--space-8) var(--space-12);
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                flex-direction: column;
                gap: var(--space-8);
            }

            .keyboard-hint {
                display: none;
            }
        }
    </style>
</body>
</html>